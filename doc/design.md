# entry-task（用户管理系统)技术设计文档



## 一、背景及目的

  通过实现简单用户管理系统，帮忙团队新人快速熟悉团队的技术栈,希望能达到几个目的:

- 熟悉简单的Web API后台架构
- 熟悉使用Go实现HTTP API（JSON、文件）
- 熟悉使用Go实现基于TCP的RPC框架（设计和实现通信协议）
- 熟悉基于Auth Token的鉴权机制和流程
- 熟悉使用Go对MySQL、Redis进行基本操作
- 对任务进度和时间有所意识
- 对代码规范、测试、文档、性能调优需要有所意识


## 二、逻辑架构设计
![系统框架图](https://github.com/wxquare/enry_task/blob/master/doc/images/1.png)

给出整体系统架构图，包括主要模块、数据流、上下文关系。

使用表格或者子章节的形式，描述主要模块和接口的功能；



## 三、核心逻辑详细设计
可包括：

1、用户登录的时序图

2、一致性方案

2、复杂事务处理，一致性方案、重试与修复机制等；

3、数据采集、计算逻辑；

4、批量任务调度、依赖关系等；

5、涉及到信息和数据安全风险，如SQL注入、伪造和篡改请求等，及其应对的校验、授权机制；



四、接口设计
给出对外接口描述，包括名称、地址或URL、类型（GRPC/HTTPS等）、协议内容（PB/JSON等）、各参数（类型、描述、限制）等；

对外接口需要给出鉴权机制和其他安全性考虑；



五、存储设计
可包括：

1、数据库表定义、字段定义、索引、主/备库读写等；

2、缓存KV设计、加载/更新/失效逻辑等；

3、文件存储介质、目录组织形式、数据格式、索引、保存周期与清理机制等；

4、消息队列等中间件选型；



六、外部依赖与限制
可包括：

1、对公司内部跨产品系统或者外部的依赖，如SPM、CoreServer、银行、供应商等。

2、受限于外部依赖的现有条件产生的限制，比如接口时延、TPS等；



七、部署方案与环境要求
可包括：

1、配置初始化、更改、下发、推送等；

2、各种存储容量的预估、需要扩容的实例、备库、账号要求等；

3、接入层、逻辑层实例数；

4、VIP、域名、防火墙等特殊要求；



八、SLA
可包括：

1、可支持的存储容量；

2、关键接口可支撑的TPS、QPS、时延等；

3、系统可用性保证，如故障时间、恢复时间、Crash率等；



九、遗留问题与风险预估
可包括：

1、本次方案受限于时间、人力、外部因素等原因，未充分设计或者实现，可能带来的影响，以及下阶段的改进计划。

2、受限于外部依赖限制、硬件资源、网络等不可控条件，存在的运行和运营风险。



十、附录
可包括一些附带的内容，例如引用的文档链接、提供的操作手册附件等。
